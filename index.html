<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="CHUM Fuel - T√≠nh ti·ªÅn xƒÉng thu√™ xe t·ª± l√°i v·ªõi nhi·ªÅu ph∆∞∆°ng ph√°p">
    <meta name="theme-color" content="#e0e5ec">
    <title>CHUM Fuel - T√≠nh xƒÉng thu√™ xe</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">‚õΩ</div>
            <h1 class="title">CHUM Fuel</h1>
            <p class="subtitle">T√≠nh xƒÉng thu√™ xe t·ª± l√°i ‚Äî nhi·ªÅu ph∆∞∆°ng ph√°p</p>
        </header>

        <!-- Method Selector (Compact) -->
        <div class="segment-control compact" id="methodSelector">
            <button class="segment active" data-method="trip">Trip</button>
            <button class="segment" data-method="distance">Qu√£ng ƒë∆∞·ªùng</button>
            <button class="segment" data-method="fuel">XƒÉng th·ª±c t·∫ø</button>
            <button class="segment" data-method="gauge">V·∫°ch taplo</button>
        </div>

        <!-- Card B: Common Data -->
        <div class="card">
            <h2 class="card-title">‚öôÔ∏è Th√¥ng s·ªë chung</h2>

            <div class="form-group">
                <label>Gi√° xƒÉng (VND/l√≠t)</label>
                <div class="stepper">
                    <button class="neu-btn stepper-btn" data-action="decrease" data-target="fuelPrice"
                        data-step="500">‚àí</button>
                    <input type="number" id="fuelPrice" class="neu-input stepper-input" value="20000" min="10000"
                        max="40000">
                    <button class="neu-btn stepper-btn" data-action="increase" data-target="fuelPrice"
                        data-step="500">+</button>
                </div>
            </div>

            <div class="form-group">
                <label>Ti√™u hao (L/100km)</label>
                <div class="stepper">
                    <button class="neu-btn stepper-btn" data-action="decrease" data-target="fuelConsumption"
                        data-step="0.5">‚àí</button>
                    <input type="number" id="fuelConsumption" class="neu-input stepper-input" value="8" min="4" max="20"
                        step="0.1">
                    <button class="neu-btn stepper-btn" data-action="increase" data-target="fuelConsumption"
                        data-step="0.5">+</button>
                </div>
            </div>

            <div class="form-group">
                <label>Dung t√≠ch b√¨nh (L)</label>
                <div class="stepper">
                    <button class="neu-btn stepper-btn" data-action="decrease" data-target="tankSize"
                        data-step="5">‚àí</button>
                    <input type="number" id="tankSize" class="neu-input stepper-input" value="55" min="20" max="100">
                    <button class="neu-btn stepper-btn" data-action="increase" data-target="tankSize"
                        data-step="5">+</button>
                </div>
            </div>

            <div class="form-group">
                <label>Ph·ª• ph√≠ ƒëi·ªÅu ki·ªán</label>
                <div class="toggle-group">
                    <label class="toggle-item">
                        <input type="checkbox" id="condCity" class="toggle-input">
                        <span class="toggle-label">üèôÔ∏è N·ªôi th√†nh (+10%)</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="condHighway" class="toggle-input">
                        <span class="toggle-label">üõ£Ô∏è Cao t·ªëc (‚àí10%)</span>
                    </label>
                    <label class="toggle-item">
                        <input type="checkbox" id="condAC" class="toggle-input">
                        <span class="toggle-label">‚ùÑÔ∏è M√°y l·∫°nh m·∫°nh (+5%)</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Card C: Dynamic Forms -->
        <div class="card" id="formCard">
            <!-- Trip A/B Method -->
            <div class="method-form active" id="form-trip">
                <h2 class="card-title">üî¢ Trip A/B</h2>
                <div class="form-group">
                    <label>Km theo Trip</label>
                    <input type="number" id="tripKm" class="neu-input" placeholder="Nh·∫≠p s·ªë km" min="0">
                </div>
                <div class="form-group">
                    <label>Sai s·ªë Trip (%)</label>
                    <div class="stepper">
                        <button class="neu-btn stepper-btn" data-action="decrease" data-target="tripError"
                            data-step="1">‚àí</button>
                        <input type="number" id="tripError" class="neu-input stepper-input" value="5" min="0" max="20">
                        <button class="neu-btn stepper-btn" data-action="increase" data-target="tripError"
                            data-step="1">+</button>
                    </div>
                    <small class="tip">üí° +5% cho xe c≈©, 0% cho xe m·ªõi</small>
                </div>
                <div class="form-group">
                    <label>Ch·ªçn Trip</label>
                    <div class="radio-group">
                        <label class="radio-item"><input type="radio" name="tripType" value="A" checked> Trip A</label>
                        <label class="radio-item"><input type="radio" name="tripType" value="B"> Trip B</label>
                    </div>
                </div>
            </div>

            <!-- Distance Method -->
            <div class="method-form" id="form-distance">
                <h2 class="card-title">üìè Qu√£ng ƒë∆∞·ªùng th·ª±c t·∫ø</h2>
                <div class="form-group">
                    <label>Km th·ª±c t·∫ø</label>
                    <input type="number" id="distanceKm" class="neu-input" placeholder="Nh·∫≠p s·ªë km" min="0">
                    <small class="tip">üí° L·∫•y theo Google Maps ho·∫∑c ODO t·ªïng</small>
                </div>
            </div>

            <!-- Actual Fuel Method -->
            <div class="method-form" id="form-fuel">
                <h2 class="card-title">‚õΩ XƒÉng th·ª±c t·∫ø (ƒë·ªï l·∫°i)</h2>
                <div class="form-group">
                    <label>S·ªë l√≠t ƒë·ªï l·∫°i</label>
                    <input type="number" id="fuelLiters" class="neu-input" placeholder="Nh·∫≠p s·ªë l√≠t" min="0" step="0.1">
                </div>
                <div class="form-group">
                    <label>Km ƒë√£ ch·∫°y (tu·ª≥ ch·ªçn)</label>
                    <input type="number" id="fuelKmDriven" class="neu-input" placeholder="ƒê·ªÉ t√≠nh ƒë/km & km/l" min="0">
                    <small class="tip">üí° ƒê·ªï ƒë·∫ßy ‚Üí ch·∫°y ‚Üí ƒë·ªï ƒë·∫ßy l·∫°i = s·ªë l√≠t ti√™u hao th·∫≠t</small>
                </div>
            </div>

            <!-- Gauge Method -->
            <div class="method-form" id="form-gauge">
                <h2 class="card-title">üìä V·∫°ch xƒÉng taplo</h2>
                <small class="tip" style="display:block; margin-bottom: 16px;">üí° T√≠nh ti·ªÅn xƒÉng d·ª±a v√†o v·∫°ch ƒë·ªìng h·ªì
                    taplo. Dung t√≠ch b√¨nh l·∫•y t·ª´ Th√¥ng s·ªë chung.</small>

                <div class="form-group">
                    <label>S·ªë v·∫°ch tr√™n ƒë·ªìng h·ªì</label>
                    <div class="stepper">
                        <button class="neu-btn stepper-btn" data-action="decrease" data-target="gaugeTotalMarks"
                            data-step="1">‚àí</button>
                        <input type="number" id="gaugeTotalMarks" class="neu-input stepper-input" value="8" min="4"
                            max="12">
                        <button class="neu-btn stepper-btn" data-action="increase" data-target="gaugeTotalMarks"
                            data-step="1">+</button>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group half">
                        <label>Nh·∫≠n xe (v·∫°ch)</label>
                        <div class="stepper">
                            <button class="neu-btn stepper-btn" data-action="decrease" data-target="gaugeStart"
                                data-step="1">‚àí</button>
                            <input type="number" id="gaugeStart" class="neu-input stepper-input" value="3" min="0"
                                max="12">
                            <button class="neu-btn stepper-btn" data-action="increase" data-target="gaugeStart"
                                data-step="1">+</button>
                        </div>
                    </div>
                    <div class="form-group half">
                        <label>Tr·∫£ xe (v·∫°ch)</label>
                        <div class="stepper">
                            <button class="neu-btn stepper-btn" data-action="decrease" data-target="gaugeEnd"
                                data-step="1">‚àí</button>
                            <input type="number" id="gaugeEnd" class="neu-input stepper-input" value="3" min="0"
                                max="12">
                            <button class="neu-btn stepper-btn" data-action="increase" data-target="gaugeEnd"
                                data-step="1">+</button>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <span id="gaugeInfo">B√¨nh 55L √∑ 8 v·∫°ch = 6.9L/v·∫°ch ‚Ä¢ Hao 0 v·∫°ch = 0.0L</span>
                </div>

                <div class="form-group" style="margin-top: 16px;">
                    <label>Km ƒë√£ ch·∫°y (tu·ª≥ ch·ªçn)</label>
                    <input type="number" id="gaugeKmDriven" class="neu-input" placeholder="ƒê·ªÉ t√≠nh ƒë/km & km/l" min="0">
                </div>
            </div>


        </div>

        <!-- Card D: Results (Sticky) -->
        <div class="card results-card" id="resultsCard">
            <h2 class="card-title">üìã K·∫øt qu·∫£</h2>
            <div class="kpi-grid">
                <div class="kpi">
                    <span class="kpi-value" id="resultFuelCost">0</span>
                    <span class="kpi-label">Ti·ªÅn xƒÉng (VND)</span>
                </div>
                <div class="kpi">
                    <span class="kpi-value" id="resultPerKm">0</span>
                    <span class="kpi-label">VND/km</span>
                </div>
                <div class="kpi">
                    <span class="kpi-value" id="resultLiters">0</span>
                    <span class="kpi-label">L√≠t ti√™u hao</span>
                </div>
                <div class="kpi">
                    <span class="kpi-value" id="resultEfficiency">0</span>
                    <span class="kpi-label">km/L</span>
                </div>
            </div>

            <div class="form-group">
                <label>Ti·ªÅn thu√™ xe</label>
                <div class="stepper">
                    <button class="neu-btn stepper-btn" data-action="decrease" data-target="rentalCost"
                        data-step="100000">‚àí</button>
                    <input type="number" id="rentalCost" class="neu-input stepper-input" value="500000" min="0"
                        step="100000">
                    <button class="neu-btn stepper-btn" data-action="increase" data-target="rentalCost"
                        data-step="100000">+</button>
                </div>
            </div>

            <div class="total-box">
                <span class="total-label">T·ªîNG CHI PH√ç</span>
                <span class="total-value" id="totalCost">0 VND</span>
            </div>

            <div class="btn-row">
                <button id="btnExport" class="neu-btn primary">üì§ Xu·∫•t k·∫øt qu·∫£</button>
            </div>
        </div>


        <!-- Export Modal -->
        <div id="exportModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üì§ Xu·∫•t k·∫øt qu·∫£</h3>
                    <button id="closeModal" class="close-btn">√ó</button>
                </div>
                <div class="modal-body">
                    <div id="exportPreview" class="export-preview"></div>
                    <div class="modal-actions">
                        <button id="btnCopyText" class="neu-btn">üìã Copy Text</button>
                        <button id="btnSaveImage" class="neu-btn primary">üñºÔ∏è L∆∞u ·∫£nh</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>CHUM Fuel v1.0 ‚Ä¢ Made with ‚ù§Ô∏è</p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="app.js"></script>
</body>

</html>